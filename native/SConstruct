import os
from SCons.Script import ARGUMENTS, SConscript, Environment, Dir

# Defaults
platform = ARGUMENTS.get("platform", "windows")           # windows/linux/macos
target   = ARGUMENTS.get("target", "template_debug")      # template_debug/template_release

env = Environment()

env["platform"] = platform
env["target"] = target

# Path to godot-cpp relative to this SConstruct
# This resolves to an absolute path like C:\Game Development\gdext\native\deps\godot-cpp
godot_cpp_path = Dir("deps/godot-cpp").abspath
env["godot_cpp_path"] = godot_cpp_path

# C++ flags
env.Append(CPPFLAGS=["-std=c++17"])
if platform != "windows":
    env.Append(CPPFLAGS=["-Wall", "-Wextra"])

# Build the voxel extension
SConscript("voxel/SConstruct", exports={"base_env": env})
